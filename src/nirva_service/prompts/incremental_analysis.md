# 增量事件分析

## 分析任务

你将分析新的转录内容，判断其中包含的事件以及这些事件与已有事件的关系。

## 输入信息

### 现有事件列表：
{existing_events}

### 新转录内容：
{new_transcript}

## 分析要求

请按以下步骤分析：

### 第1步：识别新转录中的事件
分析新转录内容，识别其中包含的事件。每个事件应该有：
- 明确的活动内容
- 时间信息（如果有）
- 地点信息（如果有）
- 参与人员（如果有）

### 第2步：判断事件关系
对于新转录中的**第一个事件**，判断它是：
- **延续 (CONTINUE)**：这个事件是已有事件列表中某个事件的延续
- **新增 (NEW)**：这是一个全新的事件

判断标准：
- **延续条件**：活动类型相似或相关、地点在同一大区域内（如家中不同房间仍算同一地点）、参与人员基本相同、时间间隔小于60分钟
- **新增条件**：活动类型完全不同（如从工作切换到运动）、地点明显变化（如从家到办公室）、参与人员完全不同、时间间隔超过60分钟

**重要**：如果第一个事件是新增，那么后续所有事件都是新增。

### 第3步：输出分析结果

返回JSON格式：

```json
{
  "analysis": {
    "first_event_relationship": "CONTINUE" | "NEW",
    "target_event_id": "如果是CONTINUE，提供要延续的事件ID，否则为null",
    "detected_events": [
      {
        "event_title": "事件标题",
        "estimated_time_range": "估计时间范围",
        "location": "地点",
        "activity_type": "活动类型",
        "people_involved": ["参与人员列表"],
        "content_summary": "内容摘要",
        "reasoning": "判断理由"
      }
    ]
  },
  "reasoning": "整体分析推理过程"
}
```

## 示例场景

### 场景1：事件延续
**现有事件**：
- Event_01: "Coffee shop work session" (09:00-10:30, Blue Bottle Coffee, work)

**新转录**：
"刚才我和团队讨论了项目的下一步计划，大家对新的功能需求达成了一致..."

**分析**：这是工作会议的延续，同样的地点和活动类型
→ `first_event_relationship: "CONTINUE"`

### 场景2：新事件
**现有事件**：
- Event_01: "Coffee shop work session" (09:00-10:30, Blue Bottle Coffee, work)

**新转录**：
"我离开了咖啡店，现在在回家的路上，准备去超市买菜..."

**分析**：地点和活动都发生了变化
→ `first_event_relationship: "NEW"`

## 注意事项

1. **时间连续性**：如果新转录的时间与最后一个事件时间间隔超过60分钟，通常是新事件
2. **地点变化**：只有明显的地点转换（如离开建筑物）才是新事件的信号，同一建筑内移动通常是延续
3. **活动类型变化**：相关的活动应该合并（如"工作"和"会议"、"吃饭"和"喝咖啡"），只有完全不同的活动类型才创建新事件
4. **参与人员变化**：小的人员变化（如有人离开或加入）不算新事件，只有完全不同的人群才创建新事件
5. **倾向于合并**：当不确定时，倾向于将活动合并到现有事件，而不是创建新事件 